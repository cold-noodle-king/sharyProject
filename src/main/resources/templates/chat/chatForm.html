<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- 필요한 스타일시트 링크 -->
    <link rel="stylesheet" href="/header/css/styles.css">
    <link rel="stylesheet" href="/footer/css/styles.css">


    <link th:href="@{/css/mypage/sideBar.css}" rel="stylesheet">
    <!-- weather 스타일 시트 -->
    <link rel="stylesheet" th:href="@{/css/weather.css}">

    <!-- Bootstrap Icons 추가 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">


    <!-- Google폰트 사용 링크 -->
    <link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css' rel='stylesheet' type='text/css'>

    <meta charset="UTF-8">
    <title>채팅 시작하기</title>
    <style>
        /* 기존 CSS와 동일한 스타일을 유지하기 위한 수정된 CSS 코드 */
        body {
            height: 100%;
        }

        /* Shary Talk 부분 배경색 변경 및 아이콘 추가 */
        .chat-header {
            text-align: center;
            font-size: 30px;
            background-color: #fff7e6; /* 연한 연보라색 */
            padding: 15px;
            border-radius: 15px;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .chat-container {
            padding: 30px;
            max-width: 100%;
            background-color: #fff7e6;
            border-radius: 12px;
            box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            margin-top: 130px;
            max-height: 80vh; /* 화면의 80% 높이까지만 차지하도록 설정 */
            overflow-y: auto; /* 내용이 많을 때 세로 스크롤 생성 */
            /* Chrome에서의 스크롤바 꾸미기 적용 */
            scrollbar-width: thin; /* 스크롤바의 너비를 얇게 */
            scrollbar-color: #b08ed9 #f1f1f1; /* 스크롤바 색상 (보라색 핸들, 회색 트랙) */
        }

        h2 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 15px;
            width: 100%;
            margin-bottom: 0px;
        }

        .tab {
            padding: 12px 40px;
            background-color: #e6d1f2;
            border-radius: 25px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            flex: 1; /* 각 탭이 동일한 너비를 갖도록 설정 */
            text-align: center; /* 탭의 글씨 중앙 정렬 */
            font-weight: bold;
            width: 150px; /* 두 탭의 고정된 동일한 너비 설정 */
        }

        .tab:hover {
            background-color: #cdb6eb;
        }

        .tab.active {
            background-color: #b08ed9;
            color: white;
        }

        .tab-content {
            display: none;
            width: 100%;
            margin-top: 20px;
        }

        .tab-content.active {
            display: block;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 16px;
        }

        th, td {
            padding: 16px;
            border: 1px solid #ddd;
            text-align: center;
            vertical-align: middle;
            width: 50%; /* 각 열이 동일한 너비를 가지도록 설정 */
        }

        th {
            background-color: #b08ed9;
            color: white;
            font-weight: bold;
            font-size: 16px;
            text-transform: uppercase;
            text-align: center; /* 텍스트와 버튼을 가운데 정렬 */
            vertical-align: middle; /* 수직으로 가운데 정렬 */
        }

        td {
            background-color: #fafafa;
        }

        button {
            background-color: #b08ed9;
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 25px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        button:hover {
            background-color: #8c6bc6;
        }

        /* 테이블 반응형 디자인 */
        @media (max-width: 768px) {
            table, th, td {
                font-size: 14px;
            }

            /* padding 값을 조정하지 않거나 동일하게 설정 */
            .chat-container {
                padding: 30px; /* 작은 화면에서도 동일한 padding 적용 */
                max-width: 90%; /* 최대 너비를 화면 너비의 90%로 설정 */
            }
        }

        /* 스크롤바 전체 */
        ::-webkit-scrollbar {
            width: 15px; /* 스크롤바의 너비 설정 */
        }

        /* 스크롤바 트랙 (스크롤바 배경) */
        ::-webkit-scrollbar-track {
            background: #f1f1f1;  /* 트랙의 배경색 */
            border-radius: 10px;  /* 둥근 모서리 */
        }

        /* 스크롤바 핸들 (이동하는 부분) */
        ::-webkit-scrollbar-thumb {
            background-color: #b08ed9; /* 핸들의 색상 (보라색) */
            border-radius: 10px;       /* 핸들의 둥근 모서리 */
            border: 2px solid #fff7e6; /* 핸들 주변 테두리 색상 */
        }

        /* 스크롤바 핸들을 마우스로 가리켰을 때 (hover) */
        ::-webkit-scrollbar-thumb:hover {
            background-color: #8c6bc6; /* hover 시 더 진한 보라색 */
        }





        pre{font-family: 'SpoqaHanSansNeo', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif !important;}



    </style>
    <script>
        function openTab(tabName) {
            // 모든 탭 콘텐츠를 숨기고 모든 탭을 비활성화 상태로 만듭니다.
            var i, tabContent, tablinks;
            tabContent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabContent.length; i++) {
                tabContent[i].style.display = "none";
            }

            tablinks = document.getElementsByClassName("tab");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
            }

            // 클릭한 탭을 활성화 상태로 만들고 해당 콘텐츠를 표시합니다.
            document.getElementById(tabName).style.display = "block";
            document.getElementById(tabName + "-tab").classList.add("active");
        }
    </script>

    <!-- Google폰트 사용 링크 -->
    <link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css' rel='stylesheet' type='text/css'>

</head>
<body onload="openTab('following')"> <!-- 페이지 로드 시 기본적으로 '팔로잉' 탭이 열리도록 설정 -->

<!-- header.html의 헤더 부분 불러오기 -->
<div th:replace="~{fragments/header :: header}"></div>

<!-- 사이드바와 메인 콘텐츠를 포함하는 레이아웃 -->
<div class="content">
    <!-- 사이드바 -->
    <div class="sidebar">
        <div class="sidebar-content">
            <img th:src="${profile?.profilePicture != null} ? ${profile.profilePicture} : '/images/profile.png'"
                 alt="프로필 사진" class="profile-img">
            <p th:text="${member.nickname}"></p>
            <pre th:text="${profile.ment}"></pre>

            <a th:href="@{/mypage/info}">개인정보</a>
            <a th:href="@{/mypage/profile}">프로필</a>
            <a th:href="@{/followAll}">친구</a>
            <a th:href="@{/chat/chatForm}">채팅</a>
            <a th:href="@{/mypage/stats}">통계</a>
            <a th:href="@{/mypage/calendar}">캘린더</a>

        </div>
        <br>
        <!-- 회원탈퇴 항목 -->
        <div class="logout">
            <a th:href="@{/member/logout}">회원탈퇴</a>
        </div>
    </div>

    <div class="chat-container">
        <div class="chat-header">
            Shary Talk <i class="bi bi-chat-heart"></i>
        </div>

        <div class="tabs">
            <div id="following-tab" class="tab active" onclick="openTab('following')">팔로잉</div>
            <div id="followers-tab" class="tab" onclick="openTab('followers')">팔로워</div>
        </div>

        <!-- 팔로잉 탭 콘텐츠 -->
        <div id="following" class="tab-content active">
            <p>팔로잉 중인 사용자와 대화를 시작하세요!</p>
            <table>
                <thead>
                <tr>
                    <th>팔로잉 ID</th>
                    <th>채팅</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${following}">
                    <td th:text="${user.followingId}"></td>
                    <td>
                        <form th:action="@{/chat/room}" method="get">
                            <input type="hidden" name="participant1Id" th:value="${#authentication.name}" />
                            <input type="hidden" name="participant2Id" th:value="${user.followingId}" />
                            <button type="submit">메시지</button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- 팔로워 탭 콘텐츠 -->
        <div id="followers" class="tab-content">
            <p>나를 팔로우하는 사용자와 대화를 시작하세요!</p>
            <table>
                <thead>
                <tr>
                    <th>팔로워 ID</th>
                    <th>채팅</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="user : ${followers}">
                    <td th:text="${user.followerId}"></td>
                    <td>
                        <form th:action="@{/chat/room}" method="get">
                            <input type="hidden" name="participant1Id" th:value="${#authentication.name}" />
                            <input type="hidden" name="participant2Id" th:value="${user.followerId}" />
                            <button type="submit">메시지</button>
                        </form>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

</div>



<!-- footer.html의 푸터 부분 불러오기 -->
<div th:replace="~{fragments/footer :: footer}"></div>
<!-- weather.js 파일 로드 -->
<script th:src="@{/js/main/weather.js}"></script>

</body>
</html>
